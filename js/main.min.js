//@prepros-append pages/device.min.js
//@prepros-append pages/common.js
//@prepros-append pages/header.js
//@prepros-append pages/index.js
//@prepros-append pages/mmenu.js
//@prepros-append pages/catalog.js
//@prepros-append pages/product.js
/*! device.js 0.1.57 */
(function(){var a,b,c,d,e,f,g,h,i;window.device={},b=window.document.documentElement,i=window.navigator.userAgent.toLowerCase(),device.ios=function(){return device.iphone()||device.ipod()||device.ipad()},device.iphone=function(){return c("iphone")},device.ipod=function(){return c("ipod")},device.ipad=function(){return c("ipad")},device.android=function(){return c("android")},device.androidPhone=function(){return device.android()&&c("mobile")},device.androidTablet=function(){return device.android()&&!c("mobile")},device.blackberry=function(){return c("blackberry")||c("bb10")||c("rim")},device.blackberryPhone=function(){return device.blackberry()&&!c("tablet")},device.blackberryTablet=function(){return device.blackberry()&&c("tablet")},device.windows=function(){return c("windows")},device.windowsPhone=function(){return device.windows()&&c("phone")},device.windowsTablet=function(){return device.windows()&&c("touch")},device.fxos=function(){return c("(mobile; rv:")||c("(tablet; rv:")},device.fxosPhone=function(){return device.fxos()&&c("mobile")},device.fxosTablet=function(){return device.fxos()&&c("tablet")},device.mobile=function(){return device.androidPhone()||device.iphone()||device.ipod()||device.windowsPhone()||device.blackberryPhone()||device.fxosPhone()},device.tablet=function(){return device.ipad()||device.androidTablet()||device.blackberryTablet()||device.windowsTablet()||device.fxosTablet()},device.portrait=function(){return 90!==Math.abs(window.orientation)},device.landscape=function(){return 90===Math.abs(window.orientation)},c=function(a){return-1!==i.indexOf(a)},e=function(a){var c;return c=new RegExp(a,"i"),b.className.match(c)},a=function(a){return e(a)?void 0:b.className+=" "+a},g=function(a){return e(a)?b.className=b.className.replace(a,""):void 0},device.ios()?device.ipad()?a("ios ipad tablet"):device.iphone()?a("ios iphone mobile"):device.ipod()&&a("ios ipod mobile"):device.android()?device.androidTablet()?a("android tablet"):a("android mobile"):device.blackberry()?device.blackberryTablet()?a("blackberry tablet"):a("blackberry mobile"):device.windows()?device.windowsTablet()?a("windows tablet"):device.windowsPhone()?a("windows mobile"):a("desktop"):device.fxos()?device.fxosTablet()?a("fxos tablet"):a("fxos mobile"):a("desktop"),d=function(){return device.landscape()?(g("portrait"),a("landscape")):(g("landscape"),a("portrait"))},h="onorientationchange"in window,f=h?"orientationchange":"resize",window.addEventListener?window.addEventListener(f,d,!1):window.attachEvent?window.attachEvent(f,d):window[f]=d,d()}).call(this);
// common.js
function getNumber(str) {
    return parseInt(str.replace(/\s/g, ''));
}

function number_format(number, decimals, dec_point, thousands_sep) {
    var i, j, kw, kd, km;
    if (isNaN(decimals = Math.abs(decimals))) {
        decimals = 2;
    }
    if (dec_point == undefined) {
        dec_point = ",";
    }
    if (thousands_sep == undefined) {
        thousands_sep = ".";
    }
    i = parseInt(number = (+number || 0).toFixed(decimals)) + "";
    if ((j = i.length) > 3) {
        j = j % 3;
    } else {
        j = 0;
    }
    km = (j ? i.substr(0, j) + thousands_sep : "");
    kw = i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousands_sep);
    kd = (decimals ? dec_point + Math.abs(number - i).toFixed(decimals).replace(/-/, 0).slice(2) : "");
    return km + kw + kd;
}

function prettify(num) {
    var n = num.toString();
    return n.replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g, "$1" + ' ');
}

function imageResize(src) {
    $('img').not('.logo__img').attr('src', src);
}
// imageResize('https://loremflickr.com/320/440');

const wWidth = $(window).width();

$('.cnt__btn').on('click', function (e) {
    let btn = $(this),
        cnt = btn.closest('.cnt'),
        count = cnt.find('.cnt__input'),
        val = count.val();
    if (btn.hasClass('cnt__plus')) {
        val++
    } else {
        if (val > 1) {
            val--
        }
    }
    count.val(val);

    if (btn.hasClass('order__cnt-btn')) {
        calcTotal();
    }
});
//header.js
$(function () {

    // VARIABLES
    const wrapper = $('.wrapper'),
        aside = $('.aside'),
        header = $('header.header'),
        headerFixed = $('.header_fixed');

    // EVENTS
    // Фиксированная шапка
    // if (wWidth < 1540) {
    //     addFixedHeader();
    // }

    $(window).on('scroll', function (e) {
        let height = header.outerHeight(),
            scrollTop = $(this).scrollTop();

        if (scrollTop > height) {
            headerFixed.addClass('active');
        } else {
            headerFixed.removeClass('active');
        }

    });
    //Открытие aside
    $('.jsMenuOpen').on('click', function (e) {
        e.preventDefault();
        openMenu();
    });

    //Закрытие aside
    $('body').on('click', function (e) {
        let target = $(e.target);

        if (wWidth<1540){
            if ((target.closest('.mmenu').length == 0 && target.closest('.jsMenuOpen').length == 0) || target.closest('.jSMenuClose').length > 0) {
                closeMenu();
            }
        } else {
            if ((target.closest('.aside').length == 0 && target.closest('.jsMenuOpen').length == 0) || target.closest('.jSMenuClose').length > 0) {
                closeMenu();
            }
        }
    });


    // FUNCTIONS
    function openMenu() {
        if (wWidth < 1540) {
            let menu = $('.mmenu');
            menu.addClass('active');
        } else {
            aside.addClass('active');
        }
    }

    function closeMenu() {
        if (wWidth < 1540) {
            let menu = $('.mmenu');
            menu.removeClass('active');
        } else {
            aside.removeClass('active');
        }
    }

    function addFixedHeader() {
        // debugger;
        // let clone = header.clone();
        // clone.removeClass('header_absolute').addClass('header_fixed');
        // wrapper.append(clone);
    }

    //VENDORS


});
//index.js
$(function () {

// VARIABLES

    // EVENTS

    // FUNCTIONS

    //VENDORS
    const ibanner = document.querySelector('.ibanner__slider');
    if (ibanner) {
        let ibannerSlider = new Swiper('.ibanner__container', {
            slidesPerView: 1,
            effect: 'slide',
            spaceBetween: 10,
            loop: true,
            watchOverflow: true,
            // Navigation arrows
            navigation: {
                nextEl: '.ibanner__next',
                prevEl: '.ibanner__prev',
            },
            // If we need pagination
            pagination: {
                el: '.ibanner__pag',
                clickable: true
            },
        });
    }
    const islider = document.querySelector('.islider');
    if (ibanner) {
        let ibannerSlider = new Swiper('.islider', {
            slidesPerView: 1,
            effect: 'slide',
            loop: true,
            spaceBetween: 0,
            watchOverflow: true,
            autoplay: {
                delay: 5000,
            },
            breakpoints: {
                // when window width is >= 320px
                767.99: {
                    slidesPerView: 2,
                    spaceBetween: 20
                },
                // when window width is >= 1200px
                1199.99: {
                    slidesPerView: 4,
                },
            }
        });
    }



});
//mmenu.js
$(function () {

    // VARIABLES

    // EVENTS
    // Переходм между вкладками
    $('.mmenu__link_arr').on('click', function (e) {
        e.preventDefault();
        let link = $(this),
            wrapper = link.next();

        wrapper.addClass('active');
    });

    //Закрытие вкладки
    $('.jsWrapClose').on('click', function (e) {
        e.preventDefault();
        let btn = $(this),
            wrapper = btn.closest('.mmenu__wrapper');

        wrapper.removeClass('active');
    });

    // Открытие меню
    $('.jsMenuOpen').on('click',function (e) {
        e.preventDefault();
        openMenu();
    });

    //Закрытие меню
    $('body').on('click', function (e) {
        let target = $(e.target);

        if (target.hasClass('mmenu active') || target.closest('.jsMenuClose').length > 0) {
            closeMenu();
        }
    });


    // FUNCTIONS
    // Функция отрытия меню
    function openMenu() {
        let menu = $('.mmenu');
        menu.addClass('active');
        // setOverflow();
    }

    // Функция закрытия меню
    function closeMenu() {
        let menu = $('.mmenu'),
            wrappers = menu.find('.mmenu__wrapper');
        menu.removeClass('active');
        wrappers.removeClass('active');
        // removeOverflow();
    }


    //VENDORS



});
//catalog.js
$(function () {

    // VARIABLES
    const rangeFrom = $('.range__input_from'),
        rangeTo = $('.range__input_to'),
        range = $('.range__slider'),
        rangeMin = range.data('min'),
        rangeMax = range.data('max'),
        form = $('.filters');

    // EVENTS
    //Раскрытие фильтров
    $('.filter__btn').on('click', function (e) {
        e.preventDefault();

        let $this = $(this),
            filter = $this.closest('.filter'),
            bottom = filter.find('.filter__bottom'),
            filters = $('.filter').not(filter),
            filtersBottom = $('.filter__bottom').not(bottom);


        filters.removeClass('active');
        filtersBottom.slideUp(300);
        bottom.slideToggle(300);
        filter.toggleClass('active');
    });

    //Закрытие фильтров
    $('body').on('click', function (e) {
        let target = $(e.target);
        if (target.closest('.filter').length == 0) {
            closeFilters();
        }

        if (target.closest('.filters').length == 0 && target.closest('.jsFiltersOpen').length == 0) {
            closeForm();
        }
    });

    //ввод цифр в поля
    $('.range__input').on('keypress', function (e) {
        if (e.key.match(/[^0-9]/g) || (this.value == 0 && e.key == 0)) {
            e.preventDefault();
        }
    });

    //Изменение данных
    $('.range__input').on('input', function (e) {
        let $this = $(this),
            val = '',
            from = getNumber(rangeFrom.val()),
            to = getNumber(rangeTo.val());

        if ($this.hasClass('range__input_from')) {
            if (from < rangeMin) {
                from = rangeMin;
            } else if (from > to) {
                from = to;
            }
            val = from;
        } else {
            if (to > rangeMax) {
                to = rangeMax;
            } else if (to < from) {
                to = from;
            }
            val = to;
        }

        let valPretty = prettify(val);

        rangeSlider.update({
            from: from,
            to: to
        });

        $this.val(valPretty);
    });

    //Изменение чеков
    $('.check__input').on('change', function (e) {
        let $this = $(this),
            filter = $this.closest('.filter');

        let checked = checkFilter(filter);

        if (checked) {
            filter.addClass('filled');
        } else {
            filter.removeClass('filled');
        }

    });

    //Сброс фильтра
    $('.filter__clear').on('click', function (e) {
        e.preventDefault();
        let $this = $(this),
            filter = $this.closest('.filter');

        clearFilter(filter);
    });

    //Сброс фильтров
    $('.filters__reset').on('click', function (e) {
        let btn = $(this),
            form = btn.closest('.filters');
        form.trigger('reset');
        rangeUpdate();

        $('.filter').each(function (x, i) {
            clearFilter($(i));
        });
    });

    //Открытие формы фильтров
    $('.jsFiltersOpen').on('click', function (e) {
        openForm();
    });

    //Закрытие формы фильтров
    $('.jsFiltersClose').on('click', function (e) {
       closeForm();
    });

    // FUNCTIONS
    function rangeUpdate() {
        let from = getNumber(rangeFrom.val()),
            to = getNumber(rangeTo.val());

        rangeSlider.update({
            from: from,
            to: to
        });
    }

    function checkFilter(filter) {
        let checks = filter.find('.check__input'),
            checked = false;

        checks.each(function (x, i) {
            if (i.checked) {
                checked = true;
            }
        });

        return checked;
    }

    function clearFilter(filter) {
        let checks = filter.find('.check__input');

        checks.each(function (x, i) {
            i.checked = false;
        });
        filter.removeClass('filled');
    }

    function closeFilters() {
        let filters = $('.filter'),
            filtersBottom = $('.filter__bottom');


        filters.removeClass('active');
        filtersBottom.slideUp(300);
    }

    function openForm() {
        form.addClass('active');
    }

    function closeForm() {
        form.removeClass('active');
    }


    //VENDORS
    $(".range__slider").ionRangeSlider({
        prettify_enabled: true,
        skin: 'round',
        hide_from_to: true,
        // hide_min_max: true,
        onChange: function (data) {
            rangeFrom.val(data.from_pretty);
            rangeTo.val(data.to_pretty);
        },
        onFinish: function (data) {
            //ToDo Здесь должень быть ajax на получение товаров
        },
    });
    let rangeSlider = $(".range__slider").data("ionRangeSlider");

    //Если планшет или мобила, то клик отрабатывает как стандартный ховер
    if (device.tablet() || device.mobile()) {
        $('.jsHoverLink').on('click', function (e) {
            e.preventDefault();
            let link = $(this),
                item = link.closest('.jsHoverItem');

            $(this).trigger('hover');
        });
    }

});
//product.js
$(function () {

    // VARIABLES

    // EVENTS
    $('.product__sw').on('click', function (e) {
        let sw = $(this),
            id = sw.data('id'),
            sws = $('.product__sw').not(sw),
            tab = $('.product__tab[data-id='+id+']'),
            tabs = $('.product__tab').not(tab);

        sws.removeClass('active');
        sw.addClass('active');
        tabs.removeClass('active');
        tab.addClass('active');

    });

    // FUNCTIONS

    //VENDORS
    const pslider = document.querySelector('.pslider');
    if (pslider) {
        let productSlider = new Swiper('.pslider__container', {
            slidesPerView: 3,
            direction: 'horizontal',
            loop: true,
            effect: 'slide',
            slideToClickedSlide: true,
            spaceBetween: -1,
            watchOverflow: true,
            // Navigation arrows
            navigation: {
                nextEl: '.pslider__next',
                prevEl: '.pslider__prev',
            },
            breakpoints: {
                // when window width is >= 320px
                767.99: {
                    spaceBetween: 0,
                    direction: 'vertical',
                },

            },
            on: {
                slideChange: function () {
                    let slide = $(this.slides[this.activeIndex]),
                        src = slide.data('src');
                    $('.product__img-img').attr('src',src);
                },

            },
        });
    }

    const precom = document.querySelector('.precom__slider');
    if (precom) {
        let productSlider = new Swiper('.precom__container', {
            slidesPerView: 2,
            effect: 'slide',
            spaceBetween: -1,
            watchOverflow: true,
            // Navigation arrows
            navigation: {
                nextEl: '.precom__next',
                prevEl: '.precom__prev',
            },
            breakpoints: {
                // when window width is >= 320px
                767.99: {
                    slidesPerView: 3,
                },
                // when window width is >= 1200px
                1199.99: {
                    slidesPerView: 5,
                },
            }
        });
    }


});

//# sourceMappingURL=main.min.js.map